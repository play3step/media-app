<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media App</title>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
    <link rel="stylesheet" href="../styles/stage.css">
</head>
<body>
    <div id ="wrap">
        <div id = "background_img">
            <div id="lp_list" class="lp-container">
                <div class="lp-item"></div>
            </div>   
        </div>
    </div>
</body>
<script>
// 재생 목록 데이터
let audios = [
    {
        audio: '../musics/00.mp3',
        image: '../musics/00.png',
        title: 'First Song',
        author: 'First Author'
    },
    {
        audio: '../musics/01.mp3',
        image: '../musics/01.png',
        title: 'Second Song',
        author: 'Second Author'
    },
    {
        audio: '../musics/02.mp3',
        image: '../musics/02.png',
        title: 'Third Song',
        author: 'Third Author'
    }
]
$(function(){
    $(".lp").draggable({
        revert: true
    });
})
// 현재 재생중인 오디오
let currentAudio = new Audio()
let lp_listDiv= $('#lp_list');
// 리스트에 추가
for(let i in audios){
    // 오디오 정보 변수
    let audio   = new Audio(audios[i].audio)
    let image   = audios[i].image
    let title   = audios[i].title
    let author  = audios[i].author
    let lpItem = $('<div class="lp-item">');
    let dom = $('<div id = "lp_container"></div>')
    lpItem.append('<p>' + author + ' - ' + title + '</p>')
    lpItem.append('<div class = "lp"><img src="' + image + '"></div>')
    lp_listDiv.append(lpItem)

    // DOM 클릭 이벤트
    dom.click(function(){
        currentAudio.pause()
        currentAudio = audio
        currentAudio.currentTime = 0;
        currentAudio.play()

        $(this).siblings().removeClass('playing')
        $(this).addClass('playing')

        $('#current_image').attr('src', image);
        $('#current_title').text(author + ' - ' + title)
    })

    $('#lp_list').append(dom)
}
// 현재 재생 기본 값 (0번 곡 자동으로 지정)
$('#lp_list > div').eq(0).click();
currentAudio.pause()

</script>
</html>